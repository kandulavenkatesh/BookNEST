doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1")
    title= isEdit ? "Edit Book – BookNEST" : "Add Book – BookNEST"

    link(
      rel="stylesheet",
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    )

    style.
      body {
        background: linear-gradient(120deg, #f8fafc 0%, #eef2ff 50%, #f8fafc 100%);
        font-family: 'Segoe UI', sans-serif;
      }
      .card-soft {
        border-radius: 18px;
        border: 1px solid #e2e8f0;
        box-shadow: 0 12px 30px rgba(15,23,42,0.08);
      }
      .pill {
        background: rgba(13,110,253,0.12);
        color: #0d6efd;
        border-radius: 999px;
        padding: 6px 12px;
        font-weight: 600;
      }

  body
    .container.py-5

      // ===== HEADER =====
      .d-flex.justify-content-between.align-items-center.mb-4
        .d-flex.align-items-center.gap-3
          span.pill Admin
          h1.h4.fw-bold.mb-0= isEdit ? "Edit Book" : "Add New Book"
        a.btn.btn-outline-secondary.rounded-pill(href="/dashboard") ← Back to Dashboard

      // ===== FORM CARD =====
      .card.card-soft.p-4
        form(
          action=isEdit ? `/admin/books/update/${book.id}` : "/admin/books"
          method="post"
          enctype="multipart/form-data"
        )

          .row.g-3

            // ===== TITLE =====
            .col-md-8
              label.form-label Title
              input.form-control(
                type="text"
                name="title"
                placeholder="Book title"
                required
                value=book ? book.title : ""
              )

            // ===== SUBTITLE =====
            .col-md-4
              label.form-label Subtitle
              input.form-control(
                type="text"
                name="subtitle"
                placeholder="Optional subtitle"
                value=book ? book.subtitle : ""
              )

            // ===== AUTHOR =====
            .col-md-6
              label.form-label Author
              select.form-select(name="author_id" required)
                option(value="") Select author
                if authors
                  each author in authors
                    option(
                      value=author.id
                      selected=book && book.author_id === author.id
                    )= author.name

            // ===== PUBLISHER =====
            .col-md-6
              label.form-label Publisher
              select.form-select(name="publisher_id")
                option(value="") Select publisher
                if publishers
                  each pub in publishers
                    option(
                      value=pub.id
                      selected=book && book.publisher_id === pub.id
                    )= pub.name

            // ===== ISBN =====
            .col-md-4
              label.form-label ISBN-10
              input.form-control(
                type="text"
                name="isbn_10"
                value=book ? book.isbn_10 : ""
              )

            .col-md-4
              label.form-label ISBN-13
              input.form-control(
                type="text"
                name="isbn_13"
                value=book ? book.isbn_13 : ""
              )

            // ===== LANGUAGE =====
            .col-md-4
              label.form-label Language
              input.form-control(
                type="text"
                name="language"
                placeholder="English"
                value=book ? book.language : ""
              )

            // ===== PAGE COUNT =====
            .col-md-4
              label.form-label Page Count
              input.form-control(
                type="number"
                name="page_count"
                value=book ? book.page_count : ""
              )

            // ===== FORMAT =====
            .col-md-4
              label.form-label Format
              select.form-select(name="format")
                option(value="") Select format
                option(
                  value="Paperback"
                  selected=book && book.format === "Paperback"
                ) Paperback
                option(
                  value="Hardcover"
                  selected=book && book.format === "Hardcover"
                ) Hardcover
                option(
                  value="Ebook"
                  selected=book && book.format === "Ebook"
                ) Ebook

            // ===== PUBLICATION DATE =====
            .col-md-4
              label.form-label Publication Date
              input.form-control(
                type="date"
                name="publication_date"
                value=book ? book.publication_date_input : ""
              )

            // ===== CATEGORIES =====
            .col-md-12
              label.form-label Categories
              .d-flex.flex-wrap.gap-3
                if categories
                  each cat in categories
                    .form-check
                      input.form-check-input(
                        type="checkbox"
                        name="categories[]"
                        value=cat.id
                        id=`cat-${cat.id}`
                        checked=!!cat.selected
                      )
                      label.form-check-label(for=`cat-${cat.id}`)= cat.name

            // ===== DESCRIPTION =====
            .col-md-12
              label.form-label Description
              textarea.form-control(
                rows="4"
                name="description"
                placeholder="Book description"
              )= book ? book.description : ""

            // ===== PDF UPLOAD =====
            .col-md-6
              label.form-label Book PDF Upload
              input.form-control(
                type="file"
                name="book_file"
                accept="application/pdf"
              )
              if isEdit && book.book_upload
                small.text-muted Existing PDF will be kept if not replaced

            // ===== COVER IMAGE URL =====
            .col-md-6
              label.form-label Cover Image URL
              input.form-control(
                type="url"
                name="cover_image_url"
                placeholder="https://example.com/book.jpg"
                value=book ? book.cover_image_url : ""
              )

          // ===== ACTIONS =====
          .d-flex.justify-content-end.mt-4.gap-2
            button.btn.btn-outline-secondary(type="reset") Reset
            button.btn.btn-primary(type="submit")
              = isEdit ? "Update Book" : "Save Book"

    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js")
